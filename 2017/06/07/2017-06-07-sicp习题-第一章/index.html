<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>sicp习题-第一章 | Jester&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="参考解答网站：http://community.schemewiki.org/?SICP-Solutionshttp://wiki.drewhess.com/wiki/Category:SICP_solutions 练习1.112345678910111213141516171819202122232425262728293031&amp;gt; 1010&amp;gt; (+ 5 3 4)12&amp;gt; (- 9">
<meta name="keywords" content="sicp">
<meta property="og:type" content="article">
<meta property="og:title" content="sicp习题-第一章">
<meta property="og:url" content="https://planan.github.io/2017/06/07/2017-06-07-sicp习题-第一章/index.html">
<meta property="og:site_name" content="Jester&#39;s Blog">
<meta property="og:description" content="参考解答网站：http://community.schemewiki.org/?SICP-Solutionshttp://wiki.drewhess.com/wiki/Category:SICP_solutions 练习1.112345678910111213141516171819202122232425262728293031&amp;gt; 1010&amp;gt; (+ 5 3 4)12&amp;gt; (- 9">
<meta property="og:updated_time" content="2017-08-23T17:13:07.417Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sicp习题-第一章">
<meta name="twitter:description" content="参考解答网站：http://community.schemewiki.org/?SICP-Solutionshttp://wiki.drewhess.com/wiki/Category:SICP_solutions 练习1.112345678910111213141516171819202122232425262728293031&amp;gt; 1010&amp;gt; (+ 5 3 4)12&amp;gt; (- 9">
  
    <link rel="alternate" href="/atom.xml" title="Jester&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jester&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://planan.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2017-06-07-sicp习题-第一章" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/07/2017-06-07-sicp习题-第一章/" class="article-date">
  <time datetime="2017-06-07T03:20:53.000Z" itemprop="datePublished">2017-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sicp习题-第一章
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考解答网站：<br><a href="http://community.schemewiki.org/?SICP-Solutions" target="_blank" rel="external">http://community.schemewiki.org/?SICP-Solutions</a><br><a href="http://wiki.drewhess.com/wiki/Category:SICP_solutions" target="_blank" rel="external">http://wiki.drewhess.com/wiki/Category:SICP_solutions</a></p>
<h3 id="练习1-1"><a href="#练习1-1" class="headerlink" title="练习1.1"></a>练习1.1</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&gt; 10</div><div class="line">10</div><div class="line">&gt; (+ 5 3 4)</div><div class="line">12</div><div class="line">&gt; (- 9 1)</div><div class="line">8</div><div class="line">&gt; (/ 6 2)</div><div class="line">3</div><div class="line">&gt; (+ (* 2 4) (- 4 6))</div><div class="line">6</div><div class="line">&gt; (define a 3)</div><div class="line">&gt; (define b (+ a 1))</div><div class="line">&gt; (+ a b (* a b))</div><div class="line">19</div><div class="line">&gt; (= a b)</div><div class="line">#f</div><div class="line">&gt; (if (and (&gt; b a) (&lt; b (* a b)))</div><div class="line">      b</div><div class="line">      a)</div><div class="line">4</div><div class="line">&gt; (cond ((= a 4) 6)</div><div class="line">        ((= b 4) (+ 6 7 a))</div><div class="line">        (else 25))</div><div class="line">16</div><div class="line">&gt; (+ 2 (if (&gt; b a) b a))</div><div class="line">6</div><div class="line">&gt; (* (cond ((&gt; a b) a)</div><div class="line">           ((&lt; a b) b)</div><div class="line">           (else -1))</div><div class="line">     (+ a 1))</div><div class="line">16</div></pre></td></tr></table></figure>
<h3 id="练习1-2"><a href="#练习1-2" class="headerlink" title="练习1.2"></a>练习1.2</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; (/ (+ 5</div><div class="line">      4</div><div class="line">      (- 2</div><div class="line">         (- 3</div><div class="line">            (+ 6</div><div class="line">               (/ 4 5)))))</div><div class="line">   (* 3</div><div class="line">      (- 6 2)</div><div class="line">      (- 2 7)))</div><div class="line">-37/150</div></pre></td></tr></table></figure>
<h3 id="练习1-3"><a href="#练习1-3" class="headerlink" title="练习1.3"></a>练习1.3</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum-of-bigger-two</span> a b c)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> a b) (<span class="name"><span class="builtin-name">&lt;=</span></span> a c)) (<span class="name"><span class="builtin-name">+</span></span> b c))</div><div class="line">        ((<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> b a) (<span class="name"><span class="builtin-name">&lt;=</span></span> b c)) (<span class="name"><span class="builtin-name">+</span></span> a c))</div><div class="line">        ((<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> c a) (<span class="name"><span class="builtin-name">&lt;=</span></span> c b)) (<span class="name"><span class="builtin-name">+</span></span> a b))</div><div class="line">        ))</div></pre></td></tr></table></figure>
<h3 id="练习1-4"><a href="#练习1-4" class="headerlink" title="练习1.4"></a>练习1.4</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">a-plus-abs-b</span> a b)</div><div class="line">  ((<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> b <span class="number">0</span>) + -) a b))</div></pre></td></tr></table></figure>
<h4 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h4><p>1.根据if表达式判断b值是否为正结果确定得出运算符为加号还是减号<br>2.将if表达式得到的运算符作为对a和b的操作</p>
<h3 id="练习1-5"><a href="#练习1-5" class="headerlink" title="练习1.5"></a>练习1.5</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">p</span>) (<span class="name">p</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">test</span> x y)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> x <span class="number">0</span>)</div><div class="line">      <span class="number">0</span></div><div class="line">      y))</div><div class="line"></div><div class="line">(<span class="name">test</span> <span class="number">0</span> (<span class="name">p</span>))</div></pre></td></tr></table></figure>
<h4 id="解答：-1"><a href="#解答：-1" class="headerlink" title="解答："></a>解答：</h4><p>1.applicative order evaluation<br><em>the expression values will be parsed before running the application.</em><br>2.normal order evaluation<br><em>expressions will be passed as needed in the application.</em><br>3.所以在 normal order eval 的时候，不需要eval 对象(p)，直接出结果0<br>而在 applicative order eval时，由于(p) 无限递归而陷入死循环</p>
<h3 id="示例1-1-7-Square-Roots-by-Newton’s-Method"><a href="#示例1-1-7-Square-Roots-by-Newton’s-Method" class="headerlink" title="示例1.1.7: Square Roots by Newton’s Method"></a>示例1.1.7: Square Roots by Newton’s Method</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">#lang racket</div><div class="line">(require sicp)</div><div class="line">(define (sqrt-iter guess x)</div><div class="line">  (if (good-enough? guess x)</div><div class="line">      guess</div><div class="line">      (sqrt-iter (improve guess x)</div><div class="line">                 x)))</div><div class="line"></div><div class="line">(define (improve guess x)</div><div class="line">  (average guess (/ x guess)))</div><div class="line"></div><div class="line">(define (average x y)</div><div class="line">  (/ (+ x y) 2))</div><div class="line"></div><div class="line">(define (good-enough? guess x)</div><div class="line">  (&lt; (abs (- (square guess) x)) 0.001))</div><div class="line"></div><div class="line">(define (sqrt x)</div><div class="line">  (sqrt-iter 1.0 x))</div><div class="line"></div><div class="line">(define (square x) (* x x))</div><div class="line"></div><div class="line">(sqrt 9)</div></pre></td></tr></table></figure>
<h3 id="练习1-6"><a href="#练习1-6" class="headerlink" title="练习1.6"></a>练习1.6</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">new-if</span> predicate then-clause else-clause)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name">predicate</span> then-clause)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> else-clause)))</div><div class="line">		</div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sqrt-iter</span> guess x)</div><div class="line">  (<span class="name">new-if</span> (<span class="name">good-enough?</span> guess x)</div><div class="line">      guess</div><div class="line">      (<span class="name">sqrt-iter</span> (<span class="name">improve</span> guess x)</div><div class="line">                 x)))</div></pre></td></tr></table></figure>
<h4 id="解答：-2"><a href="#解答：-2" class="headerlink" title="解答："></a>解答：</h4><p>使用new-if过程，不管采用应用序还是正则序都会在运行时展开所有分支条件，导致sqrt-iter不停展开消耗内存，<br>scheme中的if是经过特殊处理的，在其中一个分支满足条件后，不会展开另一个分支，在递归过程中不会形成栈溢出。</p>
<h3 id="练习1-7"><a href="#练习1-7" class="headerlink" title="练习1.7"></a>练习1.7</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">#lang racket</div><div class="line"></div><div class="line">(define (sqrt-iter guess x)</div><div class="line">  (if (good-enough? guess (improve guess x))</div><div class="line">      guess</div><div class="line">      (sqrt-iter (improve guess x)</div><div class="line">                 x)))</div><div class="line"></div><div class="line">(define (improve guess x)</div><div class="line">  (average guess (/ x guess)))</div><div class="line"></div><div class="line">(define (average x y)</div><div class="line">  (/ (+ x y) 2))</div><div class="line"></div><div class="line">(define (good-enough? guess new-guess)</div><div class="line">  (&lt; (abs (- guess new-guess)) 0.0000001))</div><div class="line"></div><div class="line">(define (sqrt x)</div><div class="line">  (sqrt-iter 1.0 x))</div><div class="line"></div><div class="line">(define (square x) (* x x))</div><div class="line"></div><div class="line">(define (new-if predicate then-clause else-clause)</div><div class="line">  (cond (predicate then-clause)</div><div class="line">        (else else-clause)))</div></pre></td></tr></table></figure>
<h3 id="练习1-8"><a href="#练习1-8" class="headerlink" title="练习1.8"></a>练习1.8</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">#lang racket</div><div class="line"></div><div class="line">(define (cbrt-iter guess x)</div><div class="line">(if (good-enough? guess (improve guess x))</div><div class="line">      guess</div><div class="line">      (cbrt-iter (improve guess x )</div><div class="line">                 x)))</div><div class="line"></div><div class="line">(define (good-enough? guess new-guess)</div><div class="line">  (&lt; (abs (- guess new-guess)) 0.0000001))</div><div class="line"></div><div class="line">(define (improve guess x)</div><div class="line">  (/ (+ (/ x (square guess))</div><div class="line">     (* 2 guess)) 3))</div><div class="line"></div><div class="line">(define (cbrt x)</div><div class="line">  (cbrt-iter 1.0 x))</div><div class="line"></div><div class="line">(define (square x) (* x x))</div><div class="line"></div><div class="line">(define (cube x) (* x x x))</div></pre></td></tr></table></figure>
<h3 id="示例1-1-8-block-structure"><a href="#示例1-1-8-block-structure" class="headerlink" title="示例1.1.8: block structure"></a>示例1.1.8: block structure</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">sqrt</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">good-enough?</span> guess new-guess)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> guess new-guess)) <span class="number">0.0000001</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average</span> x y)</div><div class="line">    (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y) <span class="number">2</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">improve</span> guess x)</div><div class="line">    (<span class="name">average</span> guess (<span class="name"><span class="builtin-name">/</span></span> x guess)))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sqrt-iter</span> guess x)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">good-enough?</span> guess (<span class="name">improve</span> guess x))</div><div class="line">        guess</div><div class="line">        (<span class="name">sqrt-iter</span> (<span class="name">improve</span> guess x)</div><div class="line">                   x)))</div><div class="line">  (<span class="name">sqrt-iter</span> <span class="number">1.0</span> x))</div></pre></td></tr></table></figure>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">;lexical scoping</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">sqrt</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">good-enough?</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">square</span> guess) x)) <span class="number">0.0000001</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average</span> y x)</div><div class="line">    (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y) <span class="number">2</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">improve</span> guess)</div><div class="line">    (<span class="name">average</span> guess (<span class="name"><span class="builtin-name">/</span></span> x guess)))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sqrt-iter</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">good-enough?</span> guess)</div><div class="line">        guess</div><div class="line">        (<span class="name">sqrt-iter</span> (<span class="name">improve</span> guess))))</div><div class="line">  (<span class="name">sqrt-iter</span> <span class="number">1.0</span>))</div></pre></td></tr></table></figure>
<h3 id="练习1-9"><a href="#练习1-9" class="headerlink" title="练习1.9"></a>练习1.9</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">+</span></span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> a <span class="number">0</span>)</div><div class="line">      b</div><div class="line">      (<span class="name">inc</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> a) b))))</div></pre></td></tr></table></figure>
<ul>
<li>递归过程<br>(+ 4 5)<br>(inc (+ 3 5))<br>(inc (inc (+ 2 5)))<br>(inc (inc (inc (+ 1 5))))<br>(inc (inc (inc (inc (+ 0 5))))<br>(inc (inc (inc (inc 5))))<br>(inc (inc (inc 6)))<br>(inc (inc 7))<br>(inc 8)<br>9</li>
</ul>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">+</span></span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> a <span class="number">0</span>)</div><div class="line">      b</div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> a) (<span class="name">inc</span> b))))</div></pre></td></tr></table></figure>
<ul>
<li>迭代过程<br>(+ 4 5)<br>(+ 3 6)<br>(+ 2 7)<br>(+ 1 8)<br>(+ 0 9)<br>9</li>
</ul>
<h3 id="练习1-10"><a href="#练习1-10" class="headerlink" title="练习1.10"></a>练习1.10</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">A</span> x y)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> y <span class="number">0</span>) <span class="number">0</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> x <span class="number">0</span>) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> y))</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> y <span class="number">1</span>) <span class="number">2</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">A</span> (<span class="name"><span class="builtin-name">-</span></span> x <span class="number">1</span>)</div><div class="line">                 (<span class="name">A</span> x (<span class="name"><span class="builtin-name">-</span></span> y <span class="number">1</span>))))))</div></pre></td></tr></table></figure>
<p>表达式的定义为：\(2^{(x-1)2^y}\)</p>
<p>(A 1 10)    \(2^{10}\) 值为1024<br>(A 2 4)      \(2^{(2-1)2^4}\)值为65536<br>(A 3 3)      \(2^{(3-1)2^3}\)值为65536</p>
<p>(define (f n) (A 0 n))    定义为: \(2n\)<br>(define (g n) (A 1 n))    定义为: \(2^n\)<br>(define (h n) (A 2 n))    定义为: \(2^{2^n}\)<br>(define (k n) (* 5 n n))  定义为：\(5n^2\)</p>
<h3 id="示例-Counting-change"><a href="#示例-Counting-change" class="headerlink" title="示例 Counting change"></a>示例 Counting change</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">;Example: Counting change</span></div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">count-change</span> amount)</div><div class="line">  (<span class="name">cc</span> amount <span class="number">5</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cc</span> amount kinds-of-coins)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> amount <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> amount <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">0</span>)) <span class="number">0</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">cc</span> amount (<span class="name"><span class="builtin-name">-</span></span> kinds-of-coins <span class="number">1</span>))</div><div class="line">                 (<span class="name">cc</span> (<span class="name"><span class="builtin-name">-</span></span> amount (<span class="name">first-denomination</span> kinds-of-coins)) kinds-of-coins)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">first-denomination</span> kinds-of-coins)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">1</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">2</span>) <span class="number">5</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">3</span>) <span class="number">10</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">4</span>) <span class="number">25</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> kinds-of-coins <span class="number">5</span>) <span class="number">50</span>)))</div></pre></td></tr></table></figure>
<h3 id="练习-Counting-change-迭代实现"><a href="#练习-Counting-change-迭代实现" class="headerlink" title="练习 Counting change 迭代实现"></a>练习 Counting change 迭代实现</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">;count-change 迭代实现</div><div class="line">#lang sicp</div><div class="line">(define (count-change amount)</div><div class="line">  (cc-iter amount (cc-vector amount) 5))</div><div class="line"></div><div class="line">(define cc-vector</div><div class="line">  (lambda (n)</div><div class="line">    (let ((a</div><div class="line">           (make-vector (+ n 1) 0)))</div><div class="line">      (vector-set! a 0 1)</div><div class="line">      a)))</div><div class="line"></div><div class="line">(define (cc-iter amount vector kinds-of-coins)</div><div class="line">  (cond ((= kinds-of-coins 0) (vector-ref vector amount))</div><div class="line">        (else</div><div class="line">         (kind-coin-iter vector kinds-of-coins (first-denomination kinds-of-coins) amount)</div><div class="line">         (cc-iter amount vector (- kinds-of-coins 1)))</div><div class="line">        )</div><div class="line">  )</div><div class="line"></div><div class="line">(define (kind-coin-iter vector kinds-of-coins coin-denomination amount)</div><div class="line">  (if (&lt;= coin-denomination amount)</div><div class="line">      (begin</div><div class="line">        (vector-set! vector coin-denomination</div><div class="line">                     (+ (vector-ref vector coin-denomination)</div><div class="line">                        (vector-ref vector</div><div class="line">                                    (- coin-denomination (first-denomination kinds-of-coins)))))</div><div class="line">        (kind-coin-iter vector kinds-of-coins (+ 1 coin-denomination) amount)))</div><div class="line">  )</div><div class="line"></div><div class="line">(define (first-denomination kinds-of-coins)</div><div class="line">  (cond ((= kinds-of-coins 1) 1)</div><div class="line">        ((= kinds-of-coins 2) 5)</div><div class="line">        ((= kinds-of-coins 3) 10)</div><div class="line">        ((= kinds-of-coins 4) 25)</div><div class="line">        ((= kinds-of-coins 5) 50)))</div><div class="line"></div><div class="line"></div><div class="line">(define(get-time)</div><div class="line">  (let ((start-time (runtime)))</div><div class="line">    (count-change 10000)</div><div class="line">    (- (runtime) start-time)))</div></pre></td></tr></table></figure>
<p>备注：计算速度与递归实现比较有明显提升</p>
<h3 id="练习-1-11"><a href="#练习-1-11" class="headerlink" title="练习 1.11"></a>练习 1.11</h3><p>递归计算<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n)</div><div class="line"> (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> n <span class="number">3</span>)</div><div class="line">     n</div><div class="line">     (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>))</div><div class="line">        (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">2</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">3</span>))))))</div></pre></td></tr></table></figure></p>
<p>迭代计算<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n)</div><div class="line">  (<span class="name">f-iter</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f-iter</span> a b c n)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&lt;</span></span> n <span class="number">3</span>) n)</div><div class="line">        ((<span class="name"><span class="builtin-name">=</span></span> n <span class="number">3</span>) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> a) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> b) c))</div><div class="line">        ((<span class="name"><span class="builtin-name">&gt;</span></span> n <span class="number">3</span>) (<span class="name">f-iter</span> b c (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> a) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> b) c) (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-12"><a href="#练习-1-12" class="headerlink" title="练习 1.12"></a>练习 1.12</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">pt-num</span> n row)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>) (<span class="name"><span class="builtin-name">=</span></span> n row) (<span class="name"><span class="builtin-name">=</span></span> row <span class="number">1</span>))</div><div class="line">      <span class="number">1</span></div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">pt-num</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>) (<span class="name"><span class="builtin-name">-</span></span> row <span class="number">1</span>)) (<span class="name">pt-num</span> n (<span class="name"><span class="builtin-name">-</span></span> row <span class="number">1</span>))))</div><div class="line">  )</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">pt</span> n row)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> n row)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> (<span class="name">pt-num</span> n row))</div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" "</span>)</div><div class="line">        (<span class="name">pt</span> (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>) row))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">pt-construct</span> row)</div><div class="line">  (<span class="name">pt-iter</span> <span class="number">1</span> row))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">pt-iter</span> n row)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> n row)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name">pt</span> <span class="number">1</span> n)</div><div class="line">        (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">        (<span class="name">pt-iter</span> (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>) row))))</div></pre></td></tr></table></figure>
<h3 id="练习-1-13"><a href="#练习-1-13" class="headerlink" title="练习 1.13"></a>练习 1.13</h3><p>中文版中  \(\Psi = \left (1 - \sqrt{5}\right ) / 2\) 这个提示被吃掉了<br>假设 \(Fib\left ( n \right ) =  \left (\Phi^{n} - \Psi ^{n}\right )/ \sqrt{5}\) 成立<br>\(n = 0\)   \(Fib\left ( n \right ) = 0\)<br>\(n = 1\)   \(Fib\left ( n \right ) = 1\)</p>
<p>\(Fib\left ( n \right ) = Fib\left ( n-1 \right ) + Fib\left ( n-2 \right )\)<br>\(Fib\left ( n \right ) = \left (\Phi^{n-1} - \Psi ^{n-1}\right )/ \sqrt{5} +  \left (\Phi^{n-2} - \Psi ^{n-2}\right )/ \sqrt{5}\)<br>\(Fib\left ( n \right ) = \Phi^{n-1}/ \sqrt{5} - \Psi ^{n-1}/ \sqrt{5} +  \Phi^{n-2}/\sqrt{5} - \Psi ^{n-2}/\sqrt{5}\)<br>\(Fib\left ( n \right ) = \left (\Phi^{n-1}/ \sqrt{5} +  \Phi^{n-2}/\sqrt{5}  \right ) - \left ( \Psi ^{n-1}/ \sqrt{5}  + \Psi ^{n-2}/\sqrt{5} \right )\)<br>\(Fib\left ( n \right ) = \Phi^{n-2}\left (\Phi  +  1  \right )\sqrt{5} - \Psi ^{n-2}\left ( \Psi  + 1\right )/ \sqrt{5}\)<br>Because \(\Phi^{2} = \Phi  +  1\) and \(\Psi^{2} = \Psi +  1\)<br>So \(Fib\left ( n \right ) = \Phi^{n}/\sqrt{5} - \Psi ^{n}/ \sqrt{5}\)<br>\(Fib\left ( n \right ) = \left ( \Phi^{n} - \Psi ^{n} \right ) / \sqrt{5} \)</p>
<p>\(Fib\left ( n \right ) +  \Psi ^{n} / \sqrt{5}   =  \Phi^{n} / \sqrt{5}\)<br>n = 1,  \(\Psi ^{n} / \sqrt{5} \) &lt; 1/2, \(\Psi ^{n} / \sqrt{5} \) 随n增加单调递减，总比1/2小<br>So \(Fib\left ( n \right )\) 是最接近 \(\Phi ^{n} / \sqrt{5}\)的整数</p>
<h3 id="练习-1-14"><a href="#练习-1-14" class="headerlink" title="练习 1.14"></a>练习 1.14</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">                                                                          (cc 11 5)</div><div class="line">                                                                              +</div><div class="line">                                                                              |</div><div class="line">                                                                              v</div><div class="line">                                                                (cc 11 4)     +     (cc -39 5)</div><div class="line">                                                                    +                    +</div><div class="line">                                                                    |                    |</div><div class="line">                                                                    |                    v</div><div class="line">                                                                    v                    0</div><div class="line">                                                      (cc 11 3)     +          (cc -14 4)</div><div class="line">                                                          +                         +</div><div class="line">                                                          |                         |</div><div class="line">                                                          |                         v</div><div class="line">                                                          v                         0</div><div class="line">                           (cc 11 2)                      +                   (cc 1 3)</div><div class="line">                               +                                                  +</div><div class="line">                               |                                                  |</div><div class="line">                               v                                                  v</div><div class="line">        (cc 11 1)              +            (cc 6 2)                      (cc 1 2)+      (cc -9 3)</div><div class="line">            +                                   +                             +              |</div><div class="line">            |                                   |                             |              v</div><div class="line">            v                                   v                             v              0</div><div class="line">(cc 11 0)   +  (cc 10 1)            (cc 6 1)    +  (cc 1 2)          (cc 1 1) +    (cc -4 2)</div><div class="line">    +              +                    +              +                 +             |</div><div class="line">    v              v                    v              v                 v             v</div><div class="line">    0       (cc 10 0) + (cc 9 1)        .   (cc 1 1)  + (cc -4 1)   (cc 1 0)+ (cc 0 1) 0</div><div class="line">                +           +           .       +           |           +         +</div><div class="line">                v           v           .       v           v           v         v</div><div class="line">                0           .           +       .           0           0         1</div><div class="line">                            .           v       .</div><div class="line">                            .           1       .</div><div class="line">                            +                   +</div><div class="line">                            v                   v</div><div class="line">                            1                   1</div></pre></td></tr></table></figure>
<p>执行币值为n, 币值种类为k, 记执行的计算步骤为N(n, k)次<br>1)首先计算N(n, 1)<br>计算N(n, 1)需要的步骤为：(cc, n, 1) = (cc, n, 0) + (cc, n - 1, 1),由于N(n, 1)本身需要记录为1步，<br>N(n, 1) = 1 + N(n, 0) + N(n-1, 1)<br>由于N(n, 0)计算会直接返回结果0， 因此记步骤为1<br>N(n, 1) = 1 + 1 + N(n-1, 1)<br>以此类推<br>N(n-1, 1) = 1 + 1 + N(n-1-1, 1)<br>N(n-1-1, 1) = 1 + 1 + N(n-1-1-1, 1)<br>···以此类推···<br>直到币值为0，也就是n减少到0（总共需要n次）<br>得到N(n, 1)=2n+1 增长的阶为 \(\theta \left ( n \right )\)</p>
<p>2)计算N(n, 2)<br>计算N(n, 2)需要的步骤为：(cc, n, 2) = (cc, n, 1) + (cc, n - 5, 2),由于N(n, 2)本身需要记录为1步，<br>N(n, 2) = 1 + N(n, 1) + N(n-5, 2)<br>N(n-5, 2) = 1 + N(n-5, 1) + N(n-10, 2)<br>N(n-10, 2) = 1 + N(n-10, 1) + N(n-15, 2)<br>···以此类推···<br>到N(0, 2)为止， 总共需要n/5次置换，由于N(n, 1)=2n+1 增长的阶为 \(\theta \left ( n \right )\)<br>则会有 n * n / 5 步量级的计算，即\(n^{2}/5\) 增长的阶为 \(\theta \left ( n^{2} \right )\)</p>
<p>3)计算N(n, 3)<br>展开原理同上<br>N(n, 3) = 1 + N(n, 2) + N(n-10, 3)<br>N(n-10, 3) = 1 + N(n-10, 2) + N(n-20, 3)<br>N(n-20, 3) = 1 + N(n-20, 2) + N(n-30, 3)<br>···以此类推···<br>到N(0, 3)为止， 总共需要n/10次置换，由于N(n, 2) 增长的阶为 \(\theta \left ( n^{2} \right )\)<br>则会有 n * n^2/5步量级的运算， 即\(n^{3}/10\) 增长的阶为 \(\theta \left ( n^{3} \right )\)</p>
<p>4)计算N(n, 4)<br>同理可得, N(n, 4)增长的阶为 \(\theta \left ( n^{4} \right )\)</p>
<p>5)计算N(n, 5)<br>同理可得, N(n, 5)增长的阶为 \(\theta \left ( n^{5} \right )\)</p>
<h5 id="结论："><a href="#结论：" class="headerlink" title="结论："></a>结论：</h5><p>1)随着现金量的增加，count-change过程计算步数增长的阶为\(\theta \left ( n^{5} \right )\)<br>2)空间复杂度则为\(\theta \left ( n \right )\), 这是由递归展开的性质决定的</p>
<h3 id="练习-1-15"><a href="#练习-1-15" class="headerlink" title="练习 1.15"></a>练习 1.15</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cube</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">p</span> x) (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> x) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">4</span> (<span class="name">cube</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sine</span> angle)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not</span></span> ( &gt; (<span class="name"><span class="builtin-name">abs</span></span> angle) <span class="number">0.1</span>))</div><div class="line">      angle</div><div class="line">      (<span class="name">p</span> (<span class="name">sine</span> (<span class="name"><span class="builtin-name">/</span></span> angle <span class="number">3.0</span>)))))</div></pre></td></tr></table></figure>
<h5 id="解答"><a href="#解答" class="headerlink" title="解答:"></a>解答:</h5><p>a) 计算弧度12.15的sin值, p将被调用5次<br>b) 当\(0.1\cdot3^{n} &gt; a \) 时，计算完毕，因此步数为\(\log_{3}10a + 1\),空间和展开次数（也就是步数一直）,所以空间和步数增长的阶为\(\theta \left ( \log n \right )\)</p>
<h3 id="练习-1-16"><a href="#练习-1-16" class="headerlink" title="练习 1.16"></a>练习 1.16</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> n <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> n) (<span class="name"><span class="builtin-name">*</span></span> n n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">expt</span></span> b n)</div><div class="line">  (<span class="name">fast-expt-iter</span> b n <span class="number">1</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-expt-iter</span> b counter product)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> counter <span class="number">0</span>) product)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> counter) (<span class="name">fast-expt-iter</span> (<span class="name">square</span> b) (<span class="name"><span class="builtin-name">/</span></span> counter <span class="number">2</span>) product))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">fast-expt-iter</span> b (<span class="name"><span class="builtin-name">-</span></span> counter <span class="number">1</span>) (<span class="name"><span class="builtin-name">*</span></span> product b)))))</div></pre></td></tr></table></figure>
<h3 id="练习-1-17"><a href="#练习-1-17" class="headerlink" title="练习 1.17"></a>练习 1.17</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> n <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">halve</span> n) (<span class="name"><span class="builtin-name">/</span></span> n <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">double</span> n) (<span class="name"><span class="builtin-name">+</span></span> n n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-*</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>) <span class="number">0</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> b) (<span class="name">double</span> (<span class="name">fast-*</span> a (<span class="name">halve</span> b))))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name">fast-*</span> a (<span class="name"><span class="builtin-name">-</span></span> b <span class="number">1</span>))))))</div></pre></td></tr></table></figure>
<h3 id="练习-1-18"><a href="#练习-1-18" class="headerlink" title="练习 1.18"></a>练习 1.18</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> n <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">halve</span> n) (<span class="name"><span class="builtin-name">/</span></span> n <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">double</span> n) (<span class="name"><span class="builtin-name">+</span></span> n n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-*</span> a b)</div><div class="line">  (<span class="name">fast-*-helper</span> a b <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-*-helper</span> a b p)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>) p)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> b) (<span class="name">fast-*-helper</span> (<span class="name">double</span> a) (<span class="name">halve</span> b) p))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">fast-*-helper</span> a (<span class="name"><span class="builtin-name">-</span></span> b <span class="number">1</span>) (<span class="name"><span class="builtin-name">+</span></span> p a)))))</div></pre></td></tr></table></figure>
<h3 id="练习-1-19"><a href="#练习-1-19" class="headerlink" title="练习 1.19"></a>练习 1.19</h3><p>1）已知<br>\(a_1 \leftarrow  bq + aq + ap \)<br>\(b_1 \leftarrow  bp + aq \)<br>代换两次有<br>\(a_2 \leftarrow  b_1q + a_1q + a_1p \) （1）<br>\(b_2 \leftarrow  b_1p + a_1q \)          （2）<br>2）展开（1） （2）<br>展开（1）<br>\(a_2 \leftarrow  b_1q + a_1q + a_1p \)<br>\(    =   \left (bp + aq \right )q +  \left (bq + aq + ap \right )q +  \left (bq + aq + ap \right )p \)<br>\(    =  bpq + aq^{2} + bq^{2} + aq^{2} + apq + bpq + apq + ap^{2} \)<br>\(    =  b \left (2pq + q^{2} \right ) + a\left (2pq + q^{2} \right )  + a \left (q^{2} + p^{2} \right ) \)<br>展开（2）<br>\(b_2 \leftarrow  \left (bp + aq \right )p + \left (bq + aq + ap\right ) q \)<br>\(    =  \left (bp + aq \right )p + \left (bq + aq + ap\right ) q \)<br>\(    =  bp^{2} + apq + bq^{2} + aq^{2} + apq \)<br>\(    =  b \left ( p^{2} + q^{2} \right ) + a\left (2pq + q^{2} \right ) \)<br>3）所以<br>\( {p}’ = p^{2} + q^{2} \)<br>\( {q}’ = 2pq + q^{2}  \)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> n) (<span class="name"><span class="builtin-name">*</span></span> n n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fib</span> n)</div><div class="line">  (<span class="name">fib-iter</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fib-iter</span> a b p q count)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> count <span class="number">0</span>) b)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> count)</div><div class="line">         (<span class="name">fib-iter</span> a</div><div class="line">                   b</div><div class="line">                   (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">square</span> q) (<span class="name">square</span> p))    <span class="comment">; compute p'</span></div><div class="line">                   (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> p q) (<span class="name">square</span> q))	<span class="comment">; compute q'</span></div><div class="line">                   (<span class="name"><span class="builtin-name">/</span></span> count <span class="number">2</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">fib-iter</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b q) (<span class="name"><span class="builtin-name">*</span></span> a q) (<span class="name"><span class="builtin-name">*</span></span> a p))</div><div class="line">                        (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b p) (<span class="name"><span class="builtin-name">*</span></span> a q))</div><div class="line">                        p</div><div class="line">                        q</div><div class="line">                        (<span class="name"><span class="builtin-name">-</span></span> count <span class="number">1</span>)))))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-20"><a href="#练习-1-20" class="headerlink" title="练习 1.20"></a>练习 1.20</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">; normal-order</div><div class="line"></div><div class="line">(define r remainder)</div><div class="line"></div><div class="line">(gcd 206 40)</div><div class="line">(if (= 40 0)</div><div class="line">    206</div><div class="line">    (gcd 40 (r 206 40)))</div><div class="line"></div><div class="line">(gcd 40 (r 206 40)))</div><div class="line"></div><div class="line">(if (=  (r 206 40) 0)</div><div class="line">    40</div><div class="line">    (gcd (r 206 40) (r 40 (r 206 40))))</div><div class="line">; if evaluates (r 206 40)</div><div class="line">(if (=  6 0)</div><div class="line">    40</div><div class="line">    (gcd (r 206 40) (r 40 (r 206 40))))</div><div class="line"></div><div class="line">(gcd (r 206 40) (r 40 (r 206 40)))</div><div class="line">(if (= (r 40 (r 206 40)) 0)</div><div class="line">    (r 40 (r 206 40))</div><div class="line">    (gcd (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))</div><div class="line">; if evaluates (r 40 (r 206 40))</div><div class="line">(if (= 4 0)</div><div class="line">    (r 40 (r 206 40))</div><div class="line">    (gcd (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))</div><div class="line"></div><div class="line">(gcd (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))</div><div class="line">(if (= (r (r 206 40) (r 40 (r 206 40))) 0)</div><div class="line">    (r 40 (r 206 40))</div><div class="line">    (gcd (r (r 206 40) (r 40 (r 206 40))) (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40))))))</div><div class="line">; if evaluates (r (r 206 40) (r 40 (r 206 40)))</div><div class="line">(if (= 2 0)</div><div class="line">    (r 40 (r 206 40))</div><div class="line">    (gcd (r (r 206 40) (r 40 (r 206 40))) (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40))))))</div><div class="line"></div><div class="line">(gcd (r (r 206 40) (r 40 (r 206 40))) (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))</div><div class="line">(if (= (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))) 0)</div><div class="line">    (r (r 206 40) (r 40 (r 206 40)))</div><div class="line">    (gcd (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))) (r (r (r 206 40) (r 40 (r 206 40))) (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))))</div><div class="line">; if evaluates (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40))))</div><div class="line">(if (= 0 0)</div><div class="line">     (r (r 206 40) (r 40 (r 206 40)))</div><div class="line">    (gcd (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))) (r (r (r 206 40) (r 40 (r 206 40))) (r (r 40 (r 206 40)) (r (r 206 40) (r 40 (r 206 40)))))))</div><div class="line"></div><div class="line">(r (r 206 40) (r 40 (r 206 40)))</div><div class="line">2</div><div class="line">;调用了18次remainder运算</div><div class="line"></div><div class="line"></div><div class="line">;applicative-order</div><div class="line"></div><div class="line">(gcd 206 40)</div><div class="line">(if (= 40 0)</div><div class="line">    206</div><div class="line">    (gcd 40 (r 206 40)))</div><div class="line"></div><div class="line">(gcd 40 6)</div><div class="line">(if (= 6 0)</div><div class="line">    40</div><div class="line">    (gcd 6 (r 40 6)))</div><div class="line"></div><div class="line">(gcd 6 4)</div><div class="line">(if (= 4 0)</div><div class="line">    6</div><div class="line">    (gcd 4 (r 6 4)))</div><div class="line"></div><div class="line">(gcd 4 2)</div><div class="line">(if (= 2 0)</div><div class="line">    4</div><div class="line">    (gcd 2 (r 4 2)))</div><div class="line"></div><div class="line">(gcd 2 0)</div><div class="line">(if (= 0 0)</div><div class="line">    2</div><div class="line">    (gcd 0 (r 2 0)))</div><div class="line">2</div><div class="line">;调用了4次remainder运算</div></pre></td></tr></table></figure>
<h3 id="实例-素数检测"><a href="#实例-素数检测" class="headerlink" title="实例 素数检测"></a>实例 素数检测</h3><p>寻找因子 \(\theta \left ( \sqrt{n} \right )\) 阶增长<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</div><div class="line">  (<span class="name">find-divisor</span> n <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</div><div class="line">        ((<span class="name">divides?</span> test-divisor n) test-divisor)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name"><span class="builtin-name">+</span></span> test-divisor <span class="number">1</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">divides?</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> b a) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name">smallest-divisor</span> n)))</div></pre></td></tr></table></figure></p>
<p>费马检查 \(\theta \left ( log n \right )\) 阶增长<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line">		 </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m)) m))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m))m))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fermat-test</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try-it</span> a)</div><div class="line">    (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">expmod</span> a n n) a))</div><div class="line">  (<span class="name">try-it</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name">random</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-prime?</span> n times)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> times <span class="number">0</span>) true)</div><div class="line">        ((<span class="name">fermat-test</span> n) (<span class="name">fast-prime?</span> n (<span class="name"><span class="builtin-name">-</span></span> times <span class="number">1</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> false)))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-21"><a href="#练习-1-21" class="headerlink" title="练习 1.21"></a>练习 1.21</h3><p>(smallest-divisor 199)<br>output: 199</p>
<p>(smallest-divisor 1999)<br>output: 1999</p>
<p>(smallest-divisor 19999)<br>output: 7</p>
<h3 id="练习-1-22"><a href="#练习-1-22" class="headerlink" title="练习 1.22"></a>练习 1.22</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</div><div class="line">  (<span class="name">find-divisor</span> n <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</div><div class="line">        ((<span class="name">divides?</span> test-divisor n) test-divisor)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name"><span class="builtin-name">+</span></span> test-divisor <span class="number">1</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">divides?</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> b a) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name">smallest-divisor</span> n)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</div><div class="line">  (<span class="name">start-prime-test</span> n (<span class="name">runtime</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">prime?</span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> n)</div><div class="line">       (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time)))</div><div class="line">      <span class="literal">#f</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span>  elapsed-time)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next-odd</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>)</div><div class="line">      n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes</span> start num)</div><div class="line">  (<span class="name">search-for-primes-helper</span> (<span class="name">next-odd</span> start) num <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes-helper</span> start num found)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> found num)</div><div class="line">      (<span class="name">search-for-primes-helper</span> (<span class="name"><span class="builtin-name">+</span></span> start <span class="number">2</span>)</div><div class="line">                                num</div><div class="line">                                (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">timed-prime-test</span> start)</div><div class="line">                                    (<span class="name"><span class="builtin-name">+</span></span> found <span class="number">1</span>)</div><div class="line">                                    found))))</div></pre></td></tr></table></figure>
<p>(search-for-primes 100000000000 3)<br>100000000003 —- 115007<br>100000000019 —- 113006<br>100000000057 —- 117006</p>
<p>avg:115006</p>
<p>(search-for-primes 1000000000000 3)<br>1000000000039 —- 353020<br>1000000000061 —- 349020<br>1000000000063 —- 362021</p>
<p>avg:354687</p>
<p>(search-for-primes 10000000000000 3)<br>10000000000037 —- 1353077<br>10000000000051 —- 1393080<br>10000000000099 —- 1372079</p>
<p>avg:1372745</p>
<p>每增加10倍， 消耗的时间增加的倍数为<br>354687 / 115006 = 3.08<br>1372745 / 354687 = 3.87</p>
<p>\( \sqrt{10} \) = 3.16</p>
<p>因此增长的阶为 \(\theta \left ( \sqrt{n} \right )\)</p>
<h3 id="练习-1-23"><a href="#练习-1-23" class="headerlink" title="练习 1.23"></a>练习 1.23</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</div><div class="line">  (<span class="name">find-divisor</span> n <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">2</span>)</div><div class="line">      <span class="number">3</span></div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">2</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</div><div class="line">        ((<span class="name">divides?</span> test-divisor n) test-divisor)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name">next</span> test-divisor)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">divides?</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> b a) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name">smallest-divisor</span> n)))</div><div class="line">  </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</div><div class="line">  (<span class="name">start-prime-test</span> n (<span class="name">runtime</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">prime?</span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> n)</div><div class="line">       (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time)))</div><div class="line">      <span class="literal">#f</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span>  elapsed-time)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next-odd</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>)</div><div class="line">      n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes</span> start num)</div><div class="line">  (<span class="name">search-for-primes-helper</span> (<span class="name">next-odd</span> start) num <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes-helper</span> start num found)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> found num)</div><div class="line">      (<span class="name">search-for-primes-helper</span> (<span class="name"><span class="builtin-name">+</span></span> start <span class="number">2</span>)</div><div class="line">                                num</div><div class="line">                                (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">timed-prime-test</span> start)</div><div class="line">                                    (<span class="name"><span class="builtin-name">+</span></span> found <span class="number">1</span>)</div><div class="line">                                    found))))</div></pre></td></tr></table></figure>
<p>使用next方法后执行运算<br>(search-for-primes 10000000000000 3)<br>10000000000037 *** 624001<br>10000000000051 *** 639602<br>10000000000099 *** 624001<br>原方法执行运算<br>(search-for-primes 10000000000000 3)<br>10000000000037 *** 1091063<br>10000000000051 *** 1071061<br>10000000000099 *** 1112064</p>
<p>分析：速度是原来的1.73倍， 并没有达到理论上的2倍，原因是在于next方法中每次执行if判断的时候，都会判断是否等于2，消耗了时间；为了验证这个问题我们可以修改为直接从3开始，每次增加2</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">2</span>)</div><div class="line">      <span class="number">2</span>)</div><div class="line">  (<span class="name">find-divisor</span> n <span class="number">3</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</div><div class="line">        ((<span class="name">divides?</span> test-divisor n) test-divisor)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name"><span class="builtin-name">+</span></span> test-divisor <span class="number">2</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">divides?</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> b a) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name">smallest-divisor</span> n)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</div><div class="line">  (<span class="name">start-prime-test</span> n (<span class="name">runtime</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">prime?</span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> n)</div><div class="line">       (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time)))</div><div class="line">      <span class="literal">#f</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span>  elapsed-time)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next-odd</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>)</div><div class="line">      n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes</span> start num)</div><div class="line">  (<span class="name">search-for-primes-helper</span> (<span class="name">next-odd</span> start) num <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes-helper</span> start num found)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> found num)</div><div class="line">      (<span class="name">search-for-primes-helper</span> (<span class="name"><span class="builtin-name">+</span></span> start <span class="number">2</span>)</div><div class="line">                                num</div><div class="line">                                (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">timed-prime-test</span> start)</div><div class="line">                                    (<span class="name"><span class="builtin-name">+</span></span> found <span class="number">1</span>)</div><div class="line">                                    found))))</div></pre></td></tr></table></figure>
<p>执行运算<br>(search-for-primes 10000000000000 3)<br>10000000000037 ***  541031<br>10000000000051 ***  540031<br>10000000000099 ***  547031<br>结论：去掉等于2的判断后，速度比之前又有提升，接近2倍的水平</p>
<h3 id="练习-1-24"><a href="#练习-1-24" class="headerlink" title="练习 1.24"></a>练习 1.24</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m)) m))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m))m))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fermat-test</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try-it</span> a)</div><div class="line">    (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">expmod</span> a n n) a))</div><div class="line">  (<span class="name">try-it</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name">random</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-prime?</span> n times)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> times <span class="number">0</span>) true)</div><div class="line">        ((<span class="name">fermat-test</span> n) (<span class="name">fast-prime?</span> n (<span class="name"><span class="builtin-name">-</span></span> times <span class="number">1</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> false)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</div><div class="line">  (<span class="name">start-prime-test</span> n (<span class="name">runtime</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">fast-prime?</span> n <span class="number">10000</span>)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> n)</div><div class="line">       (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time)))</div><div class="line">      <span class="literal">#f</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span>  elapsed-time)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</div><div class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next-odd</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>)</div><div class="line">      n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes</span> start num)</div><div class="line">  (<span class="name">search-for-primes-helper</span> (<span class="name">next-odd</span> start) num <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-primes-helper</span> start num found)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> found num)</div><div class="line">      (<span class="name">search-for-primes-helper</span> (<span class="name"><span class="builtin-name">+</span></span> start <span class="number">2</span>)</div><div class="line">                                num</div><div class="line">                                (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">timed-prime-test</span> start)</div><div class="line">                                    (<span class="name"><span class="builtin-name">+</span></span> found <span class="number">1</span>)</div><div class="line">                                    found))))</div></pre></td></tr></table></figure>
<p>(search-for-primes 100000000 3)<br>100000007 *** 215013<br>100000037 *** 227013<br>100000039 *** 211012<br>(search-for-primes 10000 3)<br>10007 *** 119007<br>10009 *** 107006<br>10037 *** 103006<br>分析：由于费马检测太快，把检查的次数提到了10000次，才得出可观察的结果<br>结论：消耗时间为2倍左右，由于 \( log 100000000 = log 10000^{2} = 2 log 10000 \) ， 符合\(\theta \left ( log n \right )\) 增长阶的预期</p>
<h3 id="练习-1-25"><a href="#练习-1-25" class="headerlink" title="练习 1.25"></a>练习 1.25</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">fast-expt</span> base exp) m))</div></pre></td></tr></table></figure>
<p>分析：<br>两种方式的差异<br>1.在求模运算前，直接使用快速乘方求得乘方的结果会得到一个很大的数作为中间结果（a^m），这会影响计算效率<br>2.实例中给出的方法，在每一次求底数的2次方或者乘以底数后，都会取一次模，这样可以保证每一次运算的数（小于等于m）都非常小的</p>
<p>实际比较效率：<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span>(<span class="name">get-time</span>)</div><div class="line">  (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">start-time</span> (<span class="name">runtime</span>)))</div><div class="line">    (<span class="name">expmod</span> <span class="number">100000</span> <span class="number">1000000</span> <span class="number">30</span>)</div><div class="line">    (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time)))</div></pre></td></tr></table></figure></p>
<p>使用fast-expt执行耗时：<br>(get-time)<br>839048</p>
<p>使用实例执行耗时：<br>(get-time)<br>0</p>
<h3 id="练习-1-26"><a href="#练习-1-26" class="headerlink" title="练习 1.26"></a>练习 1.26</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m)</div><div class="line">                       (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m))</div><div class="line">                    m))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m))m))))</div></pre></td></tr></table></figure>
<p>分析：<br>由于将square乘方运算展开为乘法运算，原本只用执行一次的(expmod base (/ exp 2))运算重复执行了1次，变成树形结构的展开<br>造成原本\(\theta \left ( log n \right )\) 增长阶的运算变成了<br>与树的深度n有关的\(\theta \left ( n \right )\) 增长阶的运算</p>
<h3 id="练习-1-27"><a href="#练习-1-27" class="headerlink" title="练习 1.27"></a>练习 1.27</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line">		 </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m)) m))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m))m))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod-check</span> n)</div><div class="line">  (<span class="name">expmod-check-helper</span> <span class="number">1</span> n <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod-check-helper</span> a n count)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> a n)</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">expmod</span> a n n) a)</div><div class="line">            (<span class="name">expmod-check-helper</span> (<span class="name"><span class="builtin-name">+</span></span> a <span class="number">1</span>) n (<span class="name"><span class="builtin-name">+</span></span> count <span class="number">1</span>))</div><div class="line">            (<span class="name">expmod-check-helper</span> (<span class="name"><span class="builtin-name">+</span></span> a <span class="number">1</span>) n count)))</div><div class="line">      (<span class="name"><span class="builtin-name">begin</span></span></div><div class="line">        (<span class="name"><span class="builtin-name">display</span></span> count) (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" #t"</span>))</div><div class="line">      ))</div></pre></td></tr></table></figure>
<p>Carmicheal-test<br>>(expmod-check 561)<br>560 #t<br>>(expmod-check 1105)<br>1104 #t<br>>(expmod-check 1729)<br>1728 #t<br>>(expmod-check 2465)<br>2464 #t<br>>(expmod-check 2821)<br>2820 #t<br>>(expmod-check 6601)<br>6600 #t</p>
<h3 id="练习-1-28"><a href="#练习-1-28" class="headerlink" title="练习 1.28"></a>练习 1.28</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line">		 </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</div><div class="line">          (<span class="name">check-nontrivial-sqrt</span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m) m))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m)) m))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">check-nontrivial-sqrt</span> n m)</div><div class="line">  (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">x</span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> n) m)))</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>)) (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name"><span class="builtin-name">-</span></span> m <span class="number">1</span>))) (<span class="name"><span class="builtin-name">=</span></span> x <span class="number">1</span>))</div><div class="line">        <span class="number">0</span></div><div class="line">        x)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">miller-rabin-test</span> n a)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">expmod</span> a (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>) n) <span class="number">1</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> n <span class="number">2</span>) <span class="literal">#t</span>)</div><div class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> n) <span class="literal">#f</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span></div><div class="line">         (<span class="name">prime-helper</span> n (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime-helper</span> n a)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> a <span class="number">0</span>) <span class="literal">#t</span>)</div><div class="line">        ((<span class="name">miller-rabin-test</span> n a) (<span class="name">miller-rabin-test</span> n (<span class="name"><span class="builtin-name">-</span></span> a <span class="number">1</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> <span class="literal">#f</span>)))</div></pre></td></tr></table></figure>
<p>> (prime? 2)<br>#t<br>> (prime? 7)<br>#t<br>> (prime? 13)<br>#t<br>> (prime? 15)<br>#f<br>> (prime? 37)<br>#t<br>> (prime? 39)<br>#f<br>> (prime? 561)<br>#f<br>> (prime? 1105)<br>#f<br>> (prime? 1729)<br>#f<br>> (prime? 2465)<br>#f<br>> (prime? 2821)<br>#f<br>> (prime? 6601)<br>#f</p>
<h3 id="练习-1-29"><a href="#练习-1-29" class="headerlink" title="练习 1.29"></a>练习 1.29</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cube</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum</span> term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">      <span class="number">0</span></div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">term</span> a)</div><div class="line">         (<span class="name">sum</span> term (<span class="name">next</span> a) next b))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">simpson-intergral</span> f a b n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> h (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">-</span></span> b a) n))</div><div class="line">  </div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">simpson-next</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>))</div><div class="line">	</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">simpson-ratio</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> k <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> k n)) <span class="number">1</span>)</div><div class="line">          ((<span class="name"><span class="builtin-name">even?</span></span> k)            <span class="number">2</span>)</div><div class="line">          (<span class="name"><span class="builtin-name">else</span></span>                 <span class="number">4</span>)))</div><div class="line">		  </div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">simpson-term</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">simpson-ratio</span> k)</div><div class="line">       (<span class="name">f</span> (<span class="name"><span class="builtin-name">+</span></span> a</div><div class="line">             (<span class="name"><span class="builtin-name">*</span></span> k h)))))</div><div class="line">			 </div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> (<span class="name"><span class="builtin-name">/</span></span> h <span class="number">3</span>) (<span class="name">sum</span> simpson-term <span class="number">0</span> simpson-next n)))</div></pre></td></tr></table></figure>
<h3 id="练习-1-30"><a href="#练习-1-30" class="headerlink" title="练习 1.30"></a>练习 1.30</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum</span> term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iter</span> a result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">        result</div><div class="line">        (<span class="name">iter</span> (<span class="name">next</span> a) (<span class="name"><span class="builtin-name">+</span></span> result (<span class="name">term</span> a)))))</div><div class="line">  (<span class="name">iter</span> a <span class="number">0</span>))</div></pre></td></tr></table></figure>
<h3 id="练习-1-31"><a href="#练习-1-31" class="headerlink" title="练习 1.31"></a>练习 1.31</h3><p>a)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">product</span> term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">      <span class="number">1</span></div><div class="line">      (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">term</span> a)</div><div class="line">         (<span class="name">product</span> term (<span class="name">next</span> a) next b))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial-next</span> n) (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial-term</span> n) n)</div><div class="line">  (<span class="name">product</span> factorial-term <span class="number">1</span> factorial-next n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-pi</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-next</span> k) (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-numerator</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> k)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">2</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>)))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-denominator</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> k)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">2</span>)))</div><div class="line">  (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">product</span> john-numerator <span class="number">1</span> john-next n)</div><div class="line">     (<span class="name">product</span> john-denominator <span class="number">1</span> john-next n)))</div></pre></td></tr></table></figure></p>
<p>b)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">product</span> term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iter</span> a result) </div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">        result</div><div class="line">        (<span class="name">iter</span> (<span class="name">next</span> a) (<span class="name"><span class="builtin-name">*</span></span> result (<span class="name">term</span> a)))))</div><div class="line">  (<span class="name">iter</span> a <span class="number">1</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial-next</span> n) (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">factorial-term</span> n) n)</div><div class="line">  (<span class="name">product</span> factorial-term <span class="number">1</span> factorial-next n))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-pi</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-next</span> k) (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-numerator</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> k)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">2</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>)))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">john-denominator</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> k)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">1</span>)</div><div class="line">        (<span class="name"><span class="builtin-name">+</span></span> k <span class="number">2</span>)))</div><div class="line">  (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">product</span> john-numerator <span class="number">1</span> john-next n)</div><div class="line">     (<span class="name">product</span> john-denominator <span class="number">1</span> john-next n)))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-32"><a href="#练习-1-32" class="headerlink" title="练习 1.32"></a>练习 1.32</h3><p>a)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">accumulate</span> combiner null-value term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">      null-value</div><div class="line">      (<span class="name">combiner</span> (<span class="name">term</span> a)</div><div class="line">                (<span class="name">accumulate</span> combiner null-value term (<span class="name">next</span> a) next b))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum</span> term a next b)</div><div class="line">  (<span class="name">accumulate</span> + <span class="number">0</span> term a next b))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">product</span> term a next b)</div><div class="line">  (<span class="name">accumulate</span> * <span class="number">1</span> term a next b))</div></pre></td></tr></table></figure></p>
<p>b)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">accumulate</span> combiner null-value term a next b)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iter</span> a result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">        result</div><div class="line">        (<span class="name">iter</span> (<span class="name">next</span> a) (<span class="name">combiner</span> (<span class="name">term</span> a) result))))</div><div class="line">  (<span class="name">iter</span> a null-value))</div><div class="line">  </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum</span> term a next b)</div><div class="line">  (<span class="name">accumulate</span> + <span class="number">0</span> term a next b))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">product</span> term a next b)</div><div class="line">  (<span class="name">accumulate</span> * <span class="number">1</span> term a next b))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-33"><a href="#练习-1-33" class="headerlink" title="练习 1.33"></a>练习 1.33</h3><p>a)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line">		 </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"> </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</div><div class="line">  (<span class="name">find-divisor</span> n <span class="number">2</span>))</div><div class="line"> </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">divides?</span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> b a) <span class="number">0</span>))</div><div class="line"> </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</div><div class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</div><div class="line">        ((<span class="name">divides?</span> test-divisor n) test-divisor)</div><div class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name">next</span> test-divisor)))))</div><div class="line"> </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">2</span>)</div><div class="line">      <span class="number">3</span></div><div class="line">      (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">2</span>)))</div><div class="line"> </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">prime?</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name">smallest-divisor</span> n)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">filtered-accumulate</span> combiner null-value term a next b filter)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iter</span> a result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">        result</div><div class="line">        (<span class="name">iter</span> (<span class="name">next</span> a)</div><div class="line">              (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">filter</span> a)</div><div class="line">                  (<span class="name">combiner</span> (<span class="name">term</span> a) result)</div><div class="line">                  result))))</div><div class="line">  (<span class="name">iter</span> a null-value))</div><div class="line"></div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum-of-squares-of-primes</span> start end)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">inc</span> x) (<span class="name"><span class="builtin-name">+</span></span> x <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sum</span> term a next b)</div><div class="line">    (<span class="name">filtered-accumulate</span> + <span class="number">0</span> term a next b prime?))</div><div class="line">  (<span class="name">sum</span> square start inc end))</div></pre></td></tr></table></figure></p>
<p>b)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">filtered-accumulate</span> combiner null-value term a next b filter)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iter</span> a result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">        result</div><div class="line">        (<span class="name">iter</span> (<span class="name">next</span> a)</div><div class="line">              (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">filter</span> a)</div><div class="line">                  (<span class="name">combiner</span> (<span class="name">term</span> a) result)</div><div class="line">                  result))))</div><div class="line">  (<span class="name">iter</span> a null-value))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">gcd</span></span> a b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>)</div><div class="line">      a</div><div class="line">  (<span class="name"><span class="builtin-name">gcd</span></span> b (<span class="name"><span class="builtin-name">remainder</span></span> a b))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">product-of-relative-primes</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">inc</span> x) (<span class="name"><span class="builtin-name">+</span></span> x <span class="number">1</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">same</span> x) x)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">relatively-prime-to-n?</span> a)</div><div class="line">    (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">gcd</span></span> a n) <span class="number">1</span>))</div><div class="line">  (<span class="name">filtered-accumulate</span> * <span class="number">1</span> same <span class="number">1</span> inc n relatively-prime-to-n?))</div></pre></td></tr></table></figure></p>
<h3 id="练习-1-34"><a href="#练习-1-34" class="headerlink" title="练习 1.34"></a>练习 1.34</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> g)</div><div class="line">  (<span class="name">g</span> <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name">f</span> f)</div><div class="line">(<span class="name">f</span> <span class="number">2</span>)</div><div class="line">(<span class="name">2</span> <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>通过展开(f f)过程， 发现(f f)被展开为(2 2)， (2 2)是无法作为过程求解的</p>
<h3 id="练习-1-35"><a href="#练习-1-35" class="headerlink" title="练习 1.35"></a>练习 1.35</h3><p>证：<br>因为\( \Psi^2 = \Psi + 1 \)<br>所以\( \Psi = 1 + 1/\Psi \)<br>黄金分割比\( \Psi \)就是函数\( x -&gt; 1 + 1/x \)的不动点<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point</span> f first-guess)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enouth?</span> v1 v2)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> v1 v2)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">next</span> (<span class="name">f</span> guess)))</div><div class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enouth?</span> guess next)</div><div class="line">          next</div><div class="line">          (<span class="name">try</span> next))))</div><div class="line">  (<span class="name">try</span> first-guess))</div><div class="line"></div><div class="line">(<span class="name">fixed-point</span> (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">/</span></span> <span class="number">1</span> x))) <span class="number">1.0</span>)</div></pre></td></tr></table></figure></p>
<p>运行结果：1.6180327868852458</p>
<h3 id="练习-1-36"><a href="#练习-1-36" class="headerlink" title="练习 1.36"></a>练习 1.36</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point</span> f first-guess)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enouth?</span> v1 v2)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> v1 v2)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">next</span> (<span class="name">f</span> guess)))</div><div class="line">      (<span class="name"><span class="builtin-name">display</span></span> next)</div><div class="line">      (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enouth?</span> guess next)</div><div class="line">          next</div><div class="line">          (<span class="name">try</span> next))))</div><div class="line">  (<span class="name">try</span> first-guess))</div><div class="line"></div><div class="line"><span class="comment">;without average damping</span></div><div class="line">(<span class="name">fixed-point</span> (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">log</span></span> <span class="number">1000</span>) (<span class="name"><span class="builtin-name">log</span></span> x))) <span class="number">2.0</span>)				</div><div class="line"></div><div class="line"><span class="comment">;with average damping</span></div><div class="line">(<span class="name">fixed-point</span> (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">average</span> x (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">log</span></span> <span class="number">1000</span>) (<span class="name"><span class="builtin-name">log</span></span> x)))) <span class="number">2.0</span>)</div></pre></td></tr></table></figure>
<p>运行结果：<br>> (fixed-point (lambda (x) (/ (log 1000) (log x))) 2.0)<br>9.965784284662087<br>3.004472209841214<br>6.279195757507157<br>3.759850702401539<br>5.215843784925895<br>4.182207192401397<br>4.8277650983445906<br>4.387593384662677<br>4.671250085763899<br>4.481403616895052<br>4.6053657460929<br>4.5230849678718865<br>4.577114682047341<br>4.541382480151454<br>4.564903245230833<br>4.549372679303342<br>4.559606491913287<br>4.552853875788271<br>4.557305529748263<br>4.554369064436181<br>4.556305311532999<br>4.555028263573554<br>4.555870396702851<br>4.555315001192079<br>4.5556812635433275<br>4.555439715736846<br>4.555599009998291<br>4.555493957531389<br>4.555563237292884<br>4.555517548417651<br>4.555547679306398<br>4.555527808516254<br>4.555540912917957<br>4.555532270803653<br>4.555532270803653</p>
<p>> (fixed-point (lambda (x) (average x (/ (log 1000) (log x)))) 2.0)<br>5.9828921423310435<br>4.922168721308343<br>4.628224318195455<br>4.568346513136242<br>4.5577305909237005<br>4.555909809045131<br>4.555599411610624<br>4.5555465521473675<br>4.555537551999825<br>4.555537551999825</p>
<h3 id="练习1-37"><a href="#练习1-37" class="headerlink" title="练习1.37"></a>练习1.37</h3><p>a)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-minimum-k</span> n d answer tolerance)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enough?</span> guess answer)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> guess answer)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-iter</span> count)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">guess</span> (<span class="name">cont-frac</span> n d count)))</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enough?</span> guess answer)</div><div class="line">        count</div><div class="line">        (<span class="name">find-iter</span> (<span class="name"><span class="builtin-name">+</span></span> count <span class="number">1</span>)))))</div><div class="line">  (<span class="name">find-iter</span> <span class="number">1</span>)</div><div class="line">  )</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac</span> n d k)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac-helper</span> i)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> i k)</div><div class="line">        (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> k) (<span class="name">d</span> k))</div><div class="line">        (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> i) ( + (<span class="name">d</span> i)(<span class="name">cont-frac-helper</span> (<span class="name"><span class="builtin-name">+</span></span> i <span class="number">1</span>))))))</div><div class="line">  (<span class="name">cont-frac-helper</span> <span class="number">1</span>))</div></pre></td></tr></table></figure></p>
<p>当k=11时，黄金分割比近似值具有十进制的4位精度，运行结果如下：<br>> (cont-frac (lambda (i) 1.0) (lambda (i) 1.0) 11)<br>0.6180555555555556</p>
<p>b)<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-minimum-k</span> n d answer tolerance)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enough?</span> guess answer)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> guess answer)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-iter</span> count)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">guess</span> (<span class="name">cont-frac</span> n d count)))</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enough?</span> guess answer)</div><div class="line">        count</div><div class="line">        (<span class="name">find-iter</span> (<span class="name"><span class="builtin-name">+</span></span> count <span class="number">1</span>)))))</div><div class="line">  (<span class="name">find-iter</span> <span class="number">1</span>)</div><div class="line">  )</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac</span> n d k)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac-helper</span> k result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span></div><div class="line">      (<span class="name"><span class="builtin-name">&gt;</span></span> k <span class="number">0</span>) (<span class="name">cont-frac-helper</span> (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> k) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">d</span> k) result)))</div><div class="line">      result))</div><div class="line">(<span class="name">cont-frac-helper</span> k <span class="number">0</span>))</div></pre></td></tr></table></figure></p>
<p>> (cont-frac (lambda (i) 1.0) (lambda (i) 1.0) 11)<br>0.6180555555555556</p>
<h3 id="练习-1-38"><a href="#练习-1-38" class="headerlink" title="练习 1.38"></a>练习 1.38</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac</span> n d k)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac-helper</span> i)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> i k)</div><div class="line">        (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> k) (<span class="name">d</span> k))</div><div class="line">        (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> i) ( + (<span class="name">d</span> i)(<span class="name">cont-frac-helper</span> (<span class="name"><span class="builtin-name">+</span></span> i <span class="number">1</span>))))))</div><div class="line">  (<span class="name">cont-frac-helper</span> <span class="number">1</span>))</div><div class="line">  </div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">d</span> i)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">exact-division?</span> k n)</div><div class="line">    (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> k n) <span class="number">0</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">term-calculater</span> k n)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">exact-division?</span> k n)</div><div class="line">         (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> i <span class="number">1</span>) <span class="number">3</span>))</div><div class="line">         <span class="number">1</span>))</div><div class="line">  (<span class="name">term-calculater</span> (<span class="name"><span class="builtin-name">+</span></span> i <span class="number">1</span>) <span class="number">3</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">euler-number</span> n)</div><div class="line">  (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">cont-frac</span> (<span class="name"><span class="builtin-name">lambda</span></span> (i) <span class="number">1.0</span>) d n) <span class="number">2</span>))</div></pre></td></tr></table></figure>
<p>运行结果：<br>> (euler-number 20)<br>2.718281828459045</p>
<h3 id="练习-1-39"><a href="#练习-1-39" class="headerlink" title="练习 1.39"></a>练习 1.39</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac</span> n d k)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cont-frac-helper</span> k result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span></div><div class="line">      (<span class="name"><span class="builtin-name">&gt;</span></span> k <span class="number">0</span>) (<span class="name">cont-frac-helper</span> (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">n</span> k) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">d</span> k) result)))</div><div class="line">      result))</div><div class="line">(<span class="name">cont-frac-helper</span> k <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">tan-cf</span> x k)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">n</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> k <span class="number">1</span>)</div><div class="line">        x</div><div class="line">        (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">square</span> x))))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">d</span> k)</div><div class="line">    (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> k) <span class="number">1</span>))</div><div class="line">  (<span class="name">cont-frac</span> n d k))</div></pre></td></tr></table></figure>
<h3 id="练习-1-40"><a href="#练习-1-40" class="headerlink" title="练习 1.40"></a>练习 1.40</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cube</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point</span> f first-guess)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enouth?</span> v1 v2)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> v1 v2)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">next</span> (<span class="name">f</span> guess)))</div><div class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enouth?</span> guess next)</div><div class="line">          next</div><div class="line">          (<span class="name">try</span> next))))</div><div class="line">  (<span class="name">try</span> first-guess))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">deriv</span> g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x)</div><div class="line">    (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">g</span> (<span class="name"><span class="builtin-name">+</span></span> x dx)) (<span class="name">g</span> x))</div><div class="line">       dx)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> dx <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">newton-transform</span> g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x)</div><div class="line">    (<span class="name"><span class="builtin-name">-</span></span> x (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">g</span> x) ((<span class="name">deriv</span> g) x)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">newtons-method</span> g guess)</div><div class="line">  (<span class="name">fixed-point</span> (<span class="name">newton-transform</span> g) guess))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cubic</span> a b c) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">cube</span> x) (<span class="name"><span class="builtin-name">*</span></span> a (<span class="name">square</span> x)) (<span class="name"><span class="builtin-name">*</span></span> b x) c)))</div></pre></td></tr></table></figure>
<p>运行结果：<br>> (newtons-method (cubic 2 3 4) 1)<br>-1.6506291914330982</p>
<h3 id="练习-1-41"><a href="#练习-1-41" class="headerlink" title="练习 1.41"></a>练习 1.41</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">double</span> f)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">f</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">inc</span> x) (<span class="name"><span class="builtin-name">+</span></span> x <span class="number">1</span>))</div></pre></td></tr></table></figure>
<p>运行结果：<br>> (((double (double double)) inc) 5)<br>21</p>
<p>展开过程：<br>(((double (double double)) inc) 5)<br>(((lambda  (x) ((double double) ((double double) x))) inc) 5)<br>(((lambda  (x) ((lambda (y) (double (double y))) ((lambda (y) (double (double y))) x))) inc) 5)<br>((((lambda (y) (double (double y))) ((lambda (y) (double (double y))) inc)) inc) 5)<br>((((lambda (y) (double (double y))) (double (double inc))) inc) 5)<br>((((double (double (double (double inc)))))) 5)<br>((((double (double (double (inc (inc x))))))) 5)<br>((double (double (inc (inc (inc (inc x) ))))) 5)<br>(double ((inc (inc (inc (inc (inc (inc (inc (inc x))))))))) 5)<br>(inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc x) 5)))))))))))))))</p>
<h3 id="练习-1-42"><a href="#练习-1-42" class="headerlink" title="练习 1.42"></a>练习 1.42</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">compose</span> f g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">g</span> x))))</div></pre></td></tr></table></figure>
<p>运行结果：<br>>((compose square inc) 6)<br>49</p>
<h3 id="练习-1-43"><a href="#练习-1-43" class="headerlink" title="练习 1.43"></a>练习 1.43</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">compose</span> f g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">g</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated</span> f times)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> times <span class="number">0</span>)</div><div class="line">        (<span class="name">compose</span> f (<span class="name">repeated</span> f (<span class="name"><span class="builtin-name">-</span></span> times <span class="number">1</span>)))</div><div class="line">        (<span class="name"><span class="builtin-name">lambda</span></span> (x) x)))</div></pre></td></tr></table></figure>
<p>运行结果：<br>>((repeated square 2) 5)<br>625</p>
<h3 id="练习-1-44"><a href="#练习-1-44" class="headerlink" title="练习 1.44"></a>练习 1.44</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> dx <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">compose</span> f g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">g</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated</span> f times)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated-iter</span> times result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> times <span class="number">1</span>)</div><div class="line">        result</div><div class="line">        (<span class="name">repeated-iter</span> (<span class="name"><span class="builtin-name">-</span></span> times <span class="number">1</span>) (<span class="name">compose</span> f result))))</div><div class="line">    (<span class="name">repeated-iter</span> times f))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">tri-average</span> x y z) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y z) <span class="number">3</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smooth</span> f)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">tri-average</span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> x dx)) (<span class="name">f</span> x) (<span class="name">f</span> (<span class="name"><span class="builtin-name">+</span></span> x dx)))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated-smooth</span> f n)</div><div class="line">  ((<span class="name">repeated</span> smooth n) f))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">impulse-maker</span> a y)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> x a)</div><div class="line">        y</div><div class="line">        <span class="number">0</span>)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> my-impulse-function</div><div class="line">  (<span class="name">impulse-maker</span> <span class="number">0</span> <span class="number">6</span>))</div></pre></td></tr></table></figure>
<p>运行结果：<br>> (exact-&gt;inexact ((repeated-smooth my-impulse-function 2) 0))<br>2.0<br>> (exact-&gt;inexact ((repeated-smooth my-impulse-function 3) 0))<br>1.5555555555555556<br>> (exact-&gt;inexact ((repeated-smooth my-impulse-function 4) 0))<br>1.4074074074074074<br>> (exact-&gt;inexact ((repeated-smooth my-impulse-function 5) 0))<br>1.2592592592592593</p>
<h3 id="练习-1-45"><a href="#练习-1-45" class="headerlink" title="练习 1.45"></a>练习 1.45</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">even?</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">2</span>) <span class="number">0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enouth?</span> x y)</div><div class="line">  (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> x y)) <span class="number">0.001</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average</span> x y) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y) <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point</span> f first-guess)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enouth?</span> v1 v2)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> v1 v2)) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">try</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">let</span></span> ((<span class="name">next</span> (<span class="name">f</span> guess)))</div><div class="line">      (<span class="name"><span class="builtin-name">display</span></span> next)</div><div class="line">      (<span class="name"><span class="builtin-name">newline</span></span>)</div><div class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">close-enouth?</span> guess next)</div><div class="line">          next</div><div class="line">          (<span class="name">try</span> next))))</div><div class="line">  (<span class="name">try</span> first-guess))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average-damp</span> f)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">average</span> x (<span class="name">f</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">compose</span> f g)</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">g</span> x))))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated</span> f times)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">repeated-iter</span> times result)</div><div class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> times <span class="number">1</span>)</div><div class="line">        result</div><div class="line">        (<span class="name">repeated-iter</span> (<span class="name"><span class="builtin-name">-</span></span> times <span class="number">1</span>) (<span class="name">compose</span> f result))))</div><div class="line">    (<span class="name">repeated-iter</span> times f))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point-of-transform</span> g transform guess)</div><div class="line">  (<span class="name">fixed-point</span> (<span class="name">transform</span> g) guess))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">mod</span> x exp)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">mod-iter</span> x exp product)</div><div class="line">    (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) product)</div><div class="line">          ((<span class="name"><span class="builtin-name">even?</span></span> exp) (<span class="name">mod-iter</span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) product))</div><div class="line">          (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">mod-iter</span> x (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) (<span class="name"><span class="builtin-name">*</span></span> x product)))))</div><div class="line">  (<span class="name">mod-iter</span> x exp <span class="number">1</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">count-exp-of-2</span> num)</div><div class="line">  (<span class="name"><span class="builtin-name">inexact-&gt;exact</span></span> (<span class="name"><span class="builtin-name">floor</span></span> (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">log</span></span> num) (<span class="name"><span class="builtin-name">log</span></span> <span class="number">2</span>)))))</div><div class="line"></div><div class="line"><span class="comment">;(define (floor-log2 n)</span></div><div class="line"><span class="comment">;  (define (iter m count)</span></div><div class="line"><span class="comment">;    (if (= m 0)</span></div><div class="line"><span class="comment">;        (- count 1)</span></div><div class="line"><span class="comment">;        (iter (arithmetic-shift m -1) (inc count))))</span></div><div class="line"><span class="comment">;  (iter n 0))</span></div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">nth-root</span> exp x)</div><div class="line">  (<span class="name">fixed-point-of-transform</span> (<span class="name"><span class="builtin-name">lambda</span></span> (y) (<span class="name"><span class="builtin-name">/</span></span> x (<span class="name">mod</span> y (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>))))</div><div class="line">                            (<span class="name">repeated</span> average-damp (<span class="name">count-exp-of-2</span> exp))</div><div class="line">                            <span class="number">1.0</span>))</div></pre></td></tr></table></figure>
<p>方法：列表验证，求不同次方根需要的平均阻尼次数<br>规律：n是以2为底的对数取整，为需要平均阻尼的次数。<br>运行结果：<br>> (nth-root 64 9)<br>1.125<br>1.107506102443933<br>1.0904273966434088<br>1.0739912891073764<br>1.0587769794029933<br>1.0460828705226157<br>1.0379678065348177<br>1.0351919919870518<br>1.0349298803213305<br>1.0349277672157835<br>1.0349277672157835<br>> (mod 1.0349277672157835 64)<br>9.000000075647126</p>
<h3 id="练习-1-46"><a href="#练习-1-46" class="headerlink" title="练习 1.46"></a>练习 1.46</h3><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">iterative-improve</span> good-enough? improve-method)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">improve-iter</span> guess)</div><div class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">good-enough?</span> guess)</div><div class="line">          guess</div><div class="line">          (<span class="name">improve-iter</span> (<span class="name">improve-method</span> guess))))</div><div class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (guess) (<span class="name">improve-iter</span> guess)))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average</span> x y)</div><div class="line">  (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y) <span class="number">2</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">sqrt</span></span> x)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">good-enouth?</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">square</span> guess) x )) <span class="number">0.0000001</span>))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">improve-method</span> guess)</div><div class="line">    (<span class="name">average</span> guess (<span class="name"><span class="builtin-name">/</span></span> x guess)))</div><div class="line">  ((<span class="name">iterative-improve</span> good-enouth? improve-method)</div><div class="line">   <span class="number">1.0</span>))</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fixed-point</span> f first-guess)</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">close-enough?</span> guess)</div><div class="line">    (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> guess (<span class="name">f</span> guess))) tolerance))</div><div class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">improve-method</span> guess)</div><div class="line">    (<span class="name">f</span> guess))</div><div class="line">  ((<span class="name">iterative-improve</span> close-enough? improve-method)</div><div class="line">   first-guess))</div></pre></td></tr></table></figure>
<p>运行结果：<br>>(fixed-point (lambda (y) (+ (sin y) (cos y))) 1.0)<br>1.2587228743052672</p>
<p>>(sqrt 3.0)<br>1.7320508100147274</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://planan.github.io/2017/06/07/2017-06-07-sicp习题-第一章/" data-id="cj7j44jll000088qwnj6og2mr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sicp/">sicp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/07/11/2017-07-11-python脚本知识点/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          python要点总结
        
      </div>
    </a>
  
  
    <a href="/2017/06/02/2017-06-01-hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Erlang/">Erlang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sicp/">sicp</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Erlang/" style="font-size: 10px;">Erlang</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/sicp/" style="font-size: 20px;">sicp</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/17/2017-08-17-sicp习题-第二章/">sicp习题-第二章</a>
          </li>
        
          <li>
            <a href="/2017/07/11/2017-07-11-python脚本知识点/">python要点总结</a>
          </li>
        
          <li>
            <a href="/2017/06/07/2017-06-07-sicp习题-第一章/">sicp习题-第一章</a>
          </li>
        
          <li>
            <a href="/2017/06/02/2017-06-01-hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/06/02/2017-06-02-Erlang常见报错和调试方法/">Erlang常见报错和调试方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Jester<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>